                                        PAGE 64
	MACRO-80 3.44	09-Dec-81	PAGE	1


                                
                                        .CREF
                                        .Z80
                                ;
                                ;       ****************************************************************
                                ;       *                                                              *
                                ;       *  ACC-BIOS fuer den AC1-2010                                  *
                                ;       *                                                              *
                                ;       *  23.10.2025                                                  *
                                ;       *                                                              *
                                ;       *  LW A: Praecitronic RAM-Disk 256 - 2048 KByte                *
                                ;       *  LW B: Floppylaufwerk MFM1.6 780/800 KByte                   *
                                ;       *  LW C: Floppylaufwerk MFM1.6 800 KByte                       *
                                ;       *  Tastatur mit Interruptsteuerung                             *
                                ;       *  Bildschirmausgabe nach ACC-Dresden                          *
                                ;       *  automatische RAM-Disk Groessenerkennung 256K bis 2048K      *
                                ;       *  Umschaltung LW B: 780K/800K mit dem 'DISK'-Befehl           *
                                ;       *                                                              *
                                ;       ****************************************************************
                                ;
  0001                          FLOPPY  EQU  1            ;BIOS mit RamDisk A: und Floppy B: und C:
                                ;
                                        IF1
                                        .PRINTX 'PASS 1'
                                        IFDEF FLOPPY
                                        .PRINTX 'BIOS mit RamDisk A: und Floppy B:, C:'
                                        ELSE
                                        .PRINTX 'BIOS mit RamDisk A: (kein Floppy-Drive)'
                                        ENDIF
                                        ENDIF
                                ;
                                        IF2
                                        .PRINTX 'PASS 2'
                                        ENDIF
                                ;
  0003                          IOBYTE  EQU  0003H
  0004                          LWBYTE  EQU  0004H        ;LW (Bit 0-3) + USER Nr.(Bit 4-7)
  07FD                          GETCO   EQU  07FDH        ;Ruecksprung in den AC1-Monitor
                                IFDEF FLOPPY
  D000                          CCP     EQU  0D000H       ;Startadresse CCP = 0D000h mit Floppy
                                ELSE
                                CCP     EQU  0E000H       ;Startadresse CCP = 0E000h ohne Floppy
                                ENDIF
  D806                          BDOS    EQU  CCP+806H     ;Startadresse BDOS
  E600                          BIOS    EQU  CCP+1600H    ;Startadresse BIOS
                                ;
  0006                          PIO1AC  EQU  06H          ;PIO1 Port A Control
  0004                          PIO1AD  EQU  04H          ;PIO1 Port A Data
  0007                          PIO1BC  EQU  07H          ;PIO1 Port B Control
  0005                          PIO1BD  EQU  05H          ;PIO1 Port B Data
  001E                          MAP     EQU  1EH          ;Seitenschaltung nach FA
                                ;
  0000                          AC1MOD  EQU  0            ;AC1 - Mode
  0001                          CPMMOD  EQU  1            ;CP/M - Mode
                                ;
                                        .PHASE BIOS
                                ;
  E600    C3 E68A                       JP   BOOT
  E603    C3 E726               BIOSWB: JP   WBOOT
	MACRO-80 3.44	09-Dec-81	PAGE	1-1


  E606    C3 F224                       JP   CONST
  E609    C3 F1D8                       JP   CONIN
  E60C    C3 F05F                       JP   CONOUT
  E60F    C3 F2C9                       JP   LIST
  E612    C3 F2CF                       JP   PUNCH
  E615    C3 F2D2                       JP   READER
  E618    C3 E66A                       JP   HOME
  E61B    C3 E641                       JP   SELDSK
  E61E    C3 E66C                       JP   SETTRK
  E621    C3 E665                       JP   SETSEC
  E624    C3 E671                       JP   SETDMA
  E627    C3 F2B8                       JP   READ
  E62A    C3 F2A7                       JP   WRITE
  E62D    C3 F2CC                       JP   LISTST
  E630    C3 E660                       JP   SECTRN
                                ;
  E633    43 50 4D 41                   DEFM 'CPMAC'      ;fuer PC/BC Progr.
  E637    43                    
  E638    C3 F411                       JP   EXIT         ;EXIT-Kommando
                                        IFDEF FLOPPY
  E63B    C3 E770                       JP   DISK         ;DISK-Umschaltung B: 780K <--> 800K
                                        ELSE
                                        JP   0000H
                                        ENDIF
  E63E    C3 0000                       JP   0000H        ;3. User-Befehl
                                ;
  E641    21 0000               SELDSK: LD   HL,0         ;HL=0 --> kein LW
  E644    3A F437                       LD   A,(NDISK)    ;Anzahl der LW
  E647    5F                            LD   E,A
  E648    79                            LD   A,C          ;C = akt. LW
  E649    BB                            CP   E
  E64A    D0                            RET  NC           ;akt. LW >= NDISK
  E64B    32 F438                       LD   (DRIVE),A    ;Merker fuer akt. LW
  E64E    FE 00                         CP   0            ;RAM-Disk?
  E650    28 04                         JR   Z,SELDS1
                                        IFDEF FLOPPY
  E652    3D                            DEC  A
  E653    32 EAB5                       LD   (UNIT),A     ;Floppy-Drive 0=780K, 1=800K
                                        ENDIF
  E656    69                    SELDS1: LD   L,C
  E657    29                            ADD  HL,HL
  E658    29                            ADD  HL,HL
  E659    29                            ADD  HL,HL
  E65A    29                            ADD  HL,HL
  E65B    11 F381                       LD   DE,DPH
  E65E    19                            ADD  HL,DE        ;zugeordneter DPH --> HL
  E65F    C9                            RET
                                ;
  E660    26 00                 SECTRN: LD   H,0          ;CP/A-Routine fuer 8 Bit
  E662    69                            LD   L,C
  E663    23                            INC  HL
  E664    C9                            RET
                                ;
  E665    79                    SETSEC: LD   A,C
  E666    32 EAAE                       LD   (SECTOR),A
  E669    C9                            RET
                                ;
  E66A    0E 00                 HOME:   LD   C,0
  E66C    79                    SETTRK: LD   A,C
  E66D    32 EAB6                       LD   (TRACK),A
	MACRO-80 3.44	09-Dec-81	PAGE	1-2


  E670    C9                            RET
                                ;
  E671    ED 43 EAAF            SETDMA: LD   (DMA),BC
  E675    C9                            RET
                                ;
  E676                          PLATZ:  DEFS BIOS+80H-PLATZ-5,0
                                ;
  E67B    00                    TZ:     DEFB 0            ;Fuellstand Tastaturpuffer
  E67C    E680                  TZOUT:  DEFW TAPU         ;Ausgabezeiger
  E67E    E680                  TZIN:   DEFW TAPU         ;Eingabezeiger
  E680                          TAPU:   DEFS 8,0          ;Tastatur-Ringpuffer
                                ;
  E688    F23C                  IV:     DEFW INTA         ;Int.-Vektor fuer CONIN (PIO)
                                ;
                                        .PRINTX '--> BOOT'
                         C      $INCLUDE BOOT.INC
                         C      ;       ****************
                         C      ;       *              *
                         C      ;       * BOOT & WBOOT *
                         C      ;       *              *
                         C      ;       ****************
                         C      ;
                         C      ;17.10.2025
                         C      ;
  E68A    F3             C      BOOT:   DI
  E68B    31 0080        C              LD   SP,80H
  E68E    ED 5E          C              IM   2            ;Bitmode Interrupt
  E690    3E E6          C              LD   A,HIGH(IV)
  E692    ED 47          C              LD   I,A
  E694    3E 88          C              LD   A,LOW(IV)    ;Interruptvektor PIO 1A
  E696    D3 06          C              OUT  (PIO1AC),A
  E698    3E CF          C              LD   A,0CFH       ;PIO - Mode 3
  E69A    D3 06          C              OUT  (PIO1AC),A
  E69C    3E FF          C              LD   A,0FFH       ;alles Eingaenge
  E69E    D3 06          C              OUT  (PIO1AC),A
  E6A0    3E B7          C              LD   A,0B7H       ;Int.-st.-wort
  E6A2    D3 06          C              OUT  (PIO1AC),A
  E6A4    3E 7F          C              LD   A,7FH        ;Int.-maske
  E6A6    D3 06          C              OUT  (PIO1AC),A
  E6A8    AF             C              XOR  A            ;Interruptvektor PIO 1B
  E6A9    D3 07          C              OUT  (PIO1BC),A
  E6AB    3E CF          C              LD   A,0CFH       ;PIO - Mode 3
  E6AD    D3 07          C              OUT  (PIO1BC),A
  E6AF    3E 84          C              LD   A,84H        ;BIT 2 & 7 = Eingang
  E6B1    D3 07          C              OUT  (PIO1BC),A
  E6B3    3E 07          C              LD   A,07H        ;Int.-st.-wort
  E6B5    D3 07          C              OUT  (PIO1BC),A
                         C      ;
  E6B7    3E DA          C              LD   A,0DAH       ;SCCH-Monitor Initialisierung
  E6B9    CB 9F          C              RES  3,A          ;ACC-Zeichensatz einschalten
  E6BB    D3 05          C              OUT  (PIO1BD),A
                         C      ;
  E6BD    3E 01          C              LD   A,CPMMOD
  E6BF    D3 1E          C              OUT  (MAP),A
                         C      ;
  E6C1    21 F2F8        C              LD   HL,TEXT1     ;Systemueberschrift
  E6C4    CD F2E7        C              CALL OUTTXT
  E6C7    CD EFCC        C              CALL RDTEST       ;Kapazitaet der RAM-Disk bestimmen
  E6CA    3A EED5        C              LD   A,(RDSIZE)   ;RD-Size: 0=256K 1=512K 2=1024K 3=2048K
  E6CD    21 F402        C              LD   HL,DP2048    ;DPB 2048K RAM-Disk
	MACRO-80 3.44	09-Dec-81	PAGE	1-3


  E6D0    DD 21 F346     C              LD   IX,TEXT1D    ;Text: "A:RAM-Disk 2048K"
  E6D4    FE 03          C              CP   3
  E6D6    28 1C          C              JR   Z,BOOT2
  E6D8    21 F3F3        C              LD   HL,DP1024    ;DPB 1024K RAM-Disk
  E6DB    DD 21 F340     C              LD   IX,TEXT1C    ;Text: "A:RAM-Disk 1024K"
  E6DF    FE 02          C              CP   2
  E6E1    28 11          C              JR   Z,BOOT2
  E6E3    21 F3E4        C              LD   HL,DP512     ;DPB 512K RAM-Disk
  E6E6    DD 21 F33B     C              LD   IX,TEXT1B    ;Text: "A:RAM-Disk 512K"
  E6EA    FE 01          C              CP   1
  E6EC    28 06          C              JR   Z,BOOT2
  E6EE    DD 21 F336     C              LD   IX,TEXT1A    ;Text: "A:RAM-Disk 256K"
  E6F2    18 08          C              JR   BOOT3        ;256K RAM-Disk, kein LDIR
                         C      ;        
  E6F4    11 F3B1        C      BOOT2:  LD   DE,DPB0
  E6F7    01 000F        C              LD   BC,15
  E6FA    ED B0          C              LDIR
  E6FC    DD E5          C      BOOT3:  PUSH IX           ;RAM-Disk Text --> HL
  E6FE    E1             C              POP  HL
  E6FF    CD F2E7        C              CALL OUTTXT
  E702    21 F34C        C              LD   HL,TEXT1E    ;Text: "B:Floppy 780K ..."
  E705    CD F2E7        C              CALL OUTTXT
                         C      ;
  E708    CD EF1A        C              CALL INITRD       ;RAM-Disk Initialisierung
                         C              IFNDEF FLOPPY
                         C              CALL CCPWR        ;CCP + BDOS --> RAM-Disk
                         C              ENDIF             ;bei jedem BOOT ausgef.
                         C      ;
  E70B    AF             C              XOR  A
  E70C    32 0003        C              LD   (IOBYTE),A   ;IOBYTE
  E70F    32 0004        C              LD   (LWBYTE),A   ;akt. LW
                         C              IFDEF FLOPPY
  E712    32 EACE        C              LD   (BLTEST),A   ;HST-Kennung ruecksetzen
                         C              ENDIF
                         C      ;
                         C      ; den FileCommander von 7600h auf 100h kopieren
  E715    21 7600        C              LD   HL,7600H
  E718    11 0100        C              LD   DE,0100H
  E71B    01 5A00        C              LD   BC,5A00H     ;5A00h Bytes
  E71E    ED B0          C              LDIR
                         C      ;
  E720    F3             C              DI
  E721    31 0080        C              LD   SP,80H
  E724    18 1B          C              JR   WBOOT1       ;CCP-Read ueberspringen
                         C      ;
  E726    F3             C      WBOOT:  DI
  E727    31 0080        C              LD   SP,80H
  E72A    CD EFAA        C              CALL CCPRD        ;CCP + BDOS laden
  E72D    3A F437        C              LD   A,(NDISK)    ;Anzahl der LW
  E730    4F             C              LD   C,A
  E731    3A 0004        C              LD   A,(LWBYTE)
  E734    E6 0F          C              AND  0FH          ;LW testen
  E736    B9             C              CP   C
  E737    38 08          C              JR   C,WBOOT1     ;akt. LW < NDISK
  E739    3A 0004        C              LD   A,(LWBYTE)
  E73C    E6 F0          C              AND  0F0H         ;LW ruecksetzen
  E73E    32 0004        C              LD   (LWBYTE),A
  E741    AF             C      WBOOT1: XOR  A
                         C              IFDEF FLOPPY
  E742    32 EAB4        C              LD   (CTAB),A     ;letzter FDC-Befehl
	MACRO-80 3.44	09-Dec-81	PAGE	1-4


                         C              ENDIF
  E745    3E C3          C              LD   A,0C3H
  E747    32 0000        C              LD   (0),A        ;JP WBOOT eintragen
  E74A    21 E603        C              LD   HL,BIOSWB
  E74D    22 0001        C              LD   (1),HL
  E750    32 0005        C              LD   (5),A        ;JP BDOS eintragen
  E753    21 D806        C              LD   HL,BDOS
  E756    22 0006        C              LD   (6),HL
  E759    32 0038        C              LD   (38H),A      ;JP ERROR eintragen
  E75C    21 F2DB        C              LD   HL,ERROR
  E75F    22 0039        C              LD   (39H),HL
  E762    01 0080        C              LD   BC,80H
  E765    CD E671        C              CALL SETDMA       ;DMA --> 80H
  E768    3A 0004        C              LD   A,(LWBYTE)
  E76B    4F             C              LD   C,A          ;aktuelles LW
  E76C    FB             C              EI
  E76D    C3 D000        C              JP   CCP          ;JP CCP
                         C      ;
                                ;
                                IFDEF FLOPPY
                                        .PRINTX '--> DISKSET'
                         C      $INCLUDE DISKSET.INC
                         C      ;       ******************************
                         C      ;       *                            *
                         C      ;       * Diskettenformat einstellen *
                         C      ;       *                            *
                         C      ;       ******************************
                         C      ;
                         C      ;23.10.2025
                         C      ;
  E770    3A E79B        C      DISK:   LD   A,(DSKSET)
  E773    3C             C              INC  A
  E774    CB 8F          C              RES  1,A
  E776    32 E79B        C              LD   (DSKSET),A   ;0=800K, 1=780K
  E779    21 E79C        C              LD   HL,DPB800
  E77C    CB 47          C              BIT  0,A
  E77E    28 03          C              JR   Z,DISK1
  E780    21 E7AD        C              LD   HL,DPB780
  E783    11 F3C2        C      DISK1:  LD   DE,DPB1      ;Disk Parameter Block LW B:
  E786    01 0011        C              LD   BC,17
  E789    ED B0          C              LDIR
  E78B    21 E7BE        C              LD   HL,DSK800    ;800K Floppy-Disk
  E78E    FE 00          C              CP   0
  E790    28 03          C              JR   Z,DISK2
  E792    21 E7D5        C              LD   HL,DSK780    ;780K Floppy-Disk
  E795    CD F2E7        C      DISK2:  CALL OUTTXT
  E798    C3 E726        C              JP   WBOOT        ;Warmstart
                         C      ;
  E79B    01             C      DSKSET: DEFB 1            ;beim Kaltstart: 780K
                         C      ;
  E79C    0050           C      DPB800: DEFW 80           ;80 Sectoren/Track
  E79E    04             C              DEFB 4            ;Blockgroesse = 2 Kbyte
  E79F    0F             C              DEFB 15
  E7A0    00             C              DEFB 0
  E7A1    018F           C              DEFW 399          ;400 * 2 Kbyte - Bloecke
  E7A3    00BF           C              DEFW 191          ;192 DIR - Eintraege
  E7A5    00E0           C              DEFW 0E0H         ;3 DIR-Bloecke
  E7A7    0030           C              DEFW 48
  E7A9    0000           C              DEFW 0            ;0 Kbyte System
                         C      ;
	MACRO-80 3.44	09-Dec-81	PAGE	1-5


  E7AB    0000           C              DEFW 0
                         C      ;
  E7AD    0050           C      DPB780: DEFW 80           ;80 Sectoren/Track
  E7AF    04             C              DEFB 4            ;Blockgroesse = 2 Kbyte
  E7B0    0F             C              DEFB 15
  E7B1    00             C              DEFB 0
  E7B2    0185           C              DEFW 389          ;390 * 2 Kbyte - Bloecke
  E7B4    007F           C              DEFW 127          ;128 DIR - Eintraege
  E7B6    00C0           C              DEFW 0C0H         ;pro DIR-Block 1Bit gesetzt
  E7B8    0020           C              DEFW 32
  E7BA    0002           C              DEFW 2            ;20 Kbyte System
                         C      ;
  E7BC    0000           C              DEFW 0
                         C      ;
  E7BE    0D 0A          C      DSK800: DEFB 0DH,0AH
  E7C0    2D 2D 2D 3E    C              DEFM '---> Drive B:=800K'
  E7C4    20 44 72 69    C      
  E7C8    76 65 20 42    C      
  E7CC    3A 3D 38 30    C      
  E7D0    30 4B          C      
  E7D2    0D 0A 00       C              DEFB 0DH,0AH,00H
  E7D5    0D 0A          C      DSK780: DEFB 0DH,0AH
  E7D7    2D 2D 2D 3E    C              DEFM '---> Drive B:=780K'
  E7DB    20 44 72 69    C      
  E7DF    76 65 20 42    C      
  E7E3    3A 3D 37 38    C      
  E7E7    30 4B          C      
  E7E9    0D 0A 00       C              DEFB 0DH,0AH,00H
                         C      ;
                                ;
                                        .PRINTX '--> FLOPPY'
                         C      $INCLUDE FLOPPY.INC
                         C      ;       ***********************
                         C      ;       *                     *
                         C      ;       * Floppy - Controller *
                         C      ;       *                     *
                         C      ;       ***********************
                         C      ;
                         C      ;17.10.2025
                         C      ;
                         C      ;Sectorberechnung Floppy
                         C      ;-----------------------
                         C      ;IN:  SECTOR aktueller BDOS-Sector
                         C      ;     SECTR letzter Disk-Sector
                         C      ;OUT: SECTR aktueller Disk-Sector
                         C      ;     DE DMA-Zeiger
                         C      ;     Z=0 neuer Disksector
                         C      ;     Z=1 Sector weiter bearbeiten
                         C      ;
  0040                   C      CFDC    EQU  40H
  0041                   C      DFDC    EQU  41H
  0044                   C      DL175   EQU  44H          ;ehem. 48H
  0043                   C      AKWAIT  EQU  43H          ;ehem. 50H
                         C      ;
  E7EC    21 EAAE        C      CPSEC:  LD   HL,SECTOR
  E7EF    E5             C              PUSH HL
  E7F0    3A EAB9        C              LD   A,(N)        ;Diskettenformat
  E7F3    4F             C              LD   C,A
  E7F4    47             C              LD   B,A          ;Maske errechnen
  E7F5    AF             C              XOR  A
	MACRO-80 3.44	09-Dec-81	PAGE	1-6


  E7F6    37             C      CPSEC1: SCF
  E7F7    17             C              RLA
  E7F8    10 FC          C              DJNZ CPSEC1
  E7FA    35             C              DEC  (HL)
  E7FB    A6             C              AND  (HL)         ;n. Sec. im Diskblock
  E7FC    21 EA51        C              LD   HL,FDMA-80H  ;FDMA-Zeiger ber.
  E7FF    11 0080        C              LD   DE,80H
  E802    47             C              LD   B,A          ;n. Sector im FDMA
  E803    04             C              INC  B
  E804    19             C      CPSEC2: ADD  HL,DE
  E805    10 FD          C              DJNZ CPSEC2
  E807    EB             C              EX   DE,HL
  E808    41             C              LD   B,C          ;(N)
  E809    E1             C              POP  HL           ;SECTOR
  E80A    7E             C              LD   A,(HL)
  E80B    34             C              INC  (HL)
  E80C    CB 3F          C      CPSEC3: SRL  A
  E80E    10 FC          C              DJNZ CPSEC3       ;B=0 (Kopf1)
                         C      ;
                         C      ;Kopf berechnen
                         C      ;--------------
                         C      ;
  E810    4F             C              LD   C,A
  E811    3A EABA        C              LD   A,(EOT)      ;DSectoren je Spur
  E814    3D             C              DEC  A
  E815    21 EAB8        C              LD   HL,SECTR
  E818    91             C              SUB  C
  E819    30 04          C              JR   NC,INHEAD    ;Kopf 1
  E81B    2F             C              CPL               ;bitweise negieren
  E81C    06 01          C              LD   B,1          ;Kopf 2
  E81E    4F             C              LD   C,A
  E81F    79             C      INHEAD: LD   A,C
  E820    35             C              DEC  (HL)
  E821    BE             C              CP   (HL)
  E822    F5             C              PUSH AF
  E823    71             C              LD   (HL),C       ;DSector eintragen
  E824    34             C              INC  (HL)         ;Sec. rel. zu 1
  E825    2B             C              DEC  HL
  E826    70             C              LD   (HL),B       ;Kopf eintragen
  E827    CB 20          C              SLA  B
  E829    CB 20          C              SLA  B
  E82B    2B             C              DEC  HL
  E82C    2B             C              DEC  HL           ;UNIT
  E82D    3A EAB5        C              LD   A,(UNIT)
  E830    E6 03          C              AND  3            ;Maske fuer LW 1-4
  E832    B0             C              OR   B
  E833    77             C              LD   (HL),A       ;Kopf n, LW x
  E834    F1             C              POP  AF
  E835    C9             C              RET
                         C      ;
                         C      ;Vergleich letzter LW-Zugriff
                         C      ;----------------------------
                         C      ;
  E836    21 EAB4        C      CPLW:   LD   HL,CTAB      ;Vergl. Operation
  E839    BE             C              CP   (HL)
  E83A    20 21          C              JR   NZ,CPLW1
  E83C    21 EAB4        C      CPLW3:  LD   HL,CTAB
  E83F    11 EABE        C              LD   DE,RESLT     ;Vergleich LW
  E842    1A             C              LD   A,(DE)
  E843    23             C              INC  HL
	MACRO-80 3.44	09-Dec-81	PAGE	1-7


  E844    AE             C              XOR  (HL)
  E845    E6 03          C              AND  3            ;nur Bit 0 und 1 vergl.
  E847    20 14          C              JR   NZ,CPLW1
  E849    23             C              INC  HL           ;Vergleich Spur
  E84A    13             C              INC  DE
  E84B    13             C              INC  DE
  E84C    13             C              INC  DE
  E84D    3A EAC3        C              LD   A,(RESLT+5)  ;Sector+1
  E850    3D             C              DEC  A            ;1. Sec. der next Spur?
  E851    1A             C              LD   A,(DE)
  E852    20 01          C              JR   NZ,CPLW2
  E854    3D             C              DEC  A            ;1 Spur zurueck
  E855    BE             C      CPLW2:  CP   (HL)
  E856    20 05          C              JR   NZ,CPLW1
  E858    23             C              INC  HL
  E859    13             C              INC  DE           ;Vergleich Kopf
  E85A    1A             C              LD   A,(DE)
  E85B    BE             C              CP   (HL)
  E85C    C8             C              RET  Z
  E85D    04             C      CPLW1:  INC  B
  E85E    C9             C              RET
                         C      ;
                         C      ;Sector schreiben
                         C      ;----------------
                         C      ;
  E85F    F3             C      WRFLO:  DI
  E860    ED 73 F5DD     C              LD   (SAVSTK),SP
  E864    31 F65D        C              LD   SP,BIOSTK
  E867    E5             C              PUSH HL
  E868    D5             C              PUSH DE
  E869    C5             C              PUSH BC
  E86A    C5             C              PUSH BC           ;C=1->Direktory schreiben
  E86B    CD EA11        C              CALL INITFL       ;Floppy initialisieren
  E86E    AF             C              XOR  A            ;Fehlermeldung loeschen
  E86F    32 EACF        C              LD   (RWTEST),A
  E872    CD E7EC        C              CALL CPSEC        ;Vergleich Sector
  E875    D5             C              PUSH DE           ;Position im HST-Puffer
  E876    06 00          C              LD   B,0
  E878    28 01          C              JR   Z,WRITE1     ;gleicher Sector
  E87A    04             C              INC  B
  E87B    CD E83C        C      WRITE1: CALL CPLW3        ;restl. Verleich
  E87E    3A EACE        C              LD   A,(BLTEST)
  E881    B7             C              OR   A
  E882    28 07          C              JR   Z,WRITE2     ;nicht schr. aber lesen
  E884    78             C              LD   A,B
  E885    B7             C              OR   A            ;neuer HST-Sector?
  E886    28 16          C              JR   Z,WRITE3     ;weder lesen noch schr.
  E888    CD E8B7        C              CALL WRITE4       ;alten HST-Sector schr.
  E88B    CD EA6A        C      WRITE2: CALL R8272        ;neuen HST-Sector lesen
  E88E    21 EAB4        C              LD   HL,CTAB      ;Werte merken
  E891    11 EAC5        C              LD   DE,CTAB2
  E894    01 0009        C              LD   BC,9         ;9 Kommandobytes
  E897    ED B0          C              LDIR
  E899    3E 01          C              LD   A,1
  E89B    32 EACE        C              LD   (BLTEST),A   ;Kennung ruecksetzen
  E89E    D1             C      WRITE3: POP  DE           ;Pos. im HST-Sector
  E89F    2A EAAF        C              LD   HL,(DMA)
  E8A2    01 0080        C              LD   BC,80H
  E8A5    ED B0          C              LDIR
  E8A7    F1             C              POP  AF           ;C=1 bei UP-Aufruf?
	MACRO-80 3.44	09-Dec-81	PAGE	1-8


  E8A8    DC E8B7        C              CALL C,WRITE4
  E8AB    3A EACF        C              LD   A,(RWTEST)   ;fuer Fehlertest
  E8AE    C1             C              POP  BC
  E8AF    D1             C              POP  DE
  E8B0    E1             C              POP  HL
  E8B1    ED 7B F5DD     C              LD   SP,(SAVSTK)
  E8B5    FB             C              EI
  E8B6    C9             C              RET
                         C      ;
                         C      ;HST-Sector schreiben
                         C      ;--------------------
                         C      ;
  E8B7    3A EACE        C      WRITE4: LD   A,(BLTEST)   ;Kennungstest
  E8BA    B7             C              OR   A
  E8BB    C8             C              RET  Z            ;nicht schreiben
  E8BC    21 EAC5        C              LD   HL,CTAB2     ;Werte letzter HST-Sec.
  E8BF    22 EAB1        C              LD   (FDCCOM),HL
  E8C2    CD EA63        C              CALL W8272        ;phys. Schreiben
  E8C5    21 EACE        C              LD   HL,BLTEST
  E8C8    36 00          C              LD   (HL),0       ;Kennung setzen
  E8CA    21 EAB4        C              LD   HL,CTAB      ;mit neuen Werten
  E8CD    22 EAB1        C              LD   (FDCCOM),HL  ;weiterarbeiten
  E8D0    C9             C              RET
                         C      ;
                         C      ;Sector lesen
                         C      ;------------
                         C      ;
  E8D1    F3             C      RDFLO:  DI
  E8D2    ED 73 F5DD     C              LD   (SAVSTK),SP
  E8D6    31 F65D        C              LD   SP,BIOSTK
  E8D9    E5             C              PUSH HL
  E8DA    D5             C              PUSH DE
  E8DB    C5             C              PUSH BC
  E8DC    CD EA11        C              CALL INITFL       ;Floppy initialisieren
  E8DF    CD E8B7        C              CALL WRITE4       ;HST-Sec. schr. (A=0 bei
  E8E2    32 EACF        C              LD   (RWTEST),A   ;fehlerfreiem schreiben)
  E8E5    CD E7EC        C              CALL CPSEC
  E8E8    D5             C              PUSH DE
  E8E9    06 00          C              LD   B,0
  E8EB    28 01          C              JR   Z,READ1
  E8ED    04             C              INC  B
  E8EE    3E 46          C      READ1:  LD   A,46H
  E8F0    CD E836        C              CALL CPLW
  E8F3    78             C              LD   A,B
  E8F4    B7             C              OR   A
  E8F5    C4 EA6A        C              CALL NZ,R8272
  E8F8    E1             C              POP  HL
  E8F9    ED 5B EAAF     C              LD   DE,(DMA)
  E8FD    01 0080        C              LD   BC,80H
  E900    ED B0          C              LDIR
  E902    3A EACF        C              LD   A,(RWTEST)
  E905    C1             C              POP  BC
  E906    D1             C              POP  DE
  E907    E1             C              POP  HL
  E908    ED 7B F5DD     C              LD   SP,(SAVSTK)
  E90C    FB             C              EI
  E90D    C9             C              RET
                         C      ;
                         C      ;Motor einschalten
                         C      ;-----------------
	MACRO-80 3.44	09-Dec-81	PAGE	1-9


                         C      ;
  E90E    E5             C      MOTON:  PUSH HL
  E90F    21 EAB3        C              LD   HL,STREG
  E912    3A EACE        C              LD   A,(BLTEST)   ;Kennungstest
  E915    B7             C              OR   A
  E916    28 05          C              JR   Z,HSTRD      ;(neuen) Hostsector lesen
  E918    3A EAC6        C              LD   A,(CTAB2+1)  ;(alten) Hostsector schreiben
  E91B    18 03          C              JR   HSTWR
  E91D    3A EAB5        C      HSTRD:  LD   A,(UNIT)
  E920    CB 47          C      HSTWR:  BIT  0,A          ;2 phys. LW
  E922    20 04          C              JR   NZ,MOTOR1
  E924    CB C6          C              SET  0,(HL)
  E926    18 02          C              JR   MOTOR0
  E928    CB DE          C      MOTOR1: SET  3,(HL)
  E92A    7E             C      MOTOR0: LD   A,(HL)
  E92B    D3 44          C              OUT  (DL175),A
  E92D    E1             C              POP  HL
  E92E    CD EA04        C      ONLOOP: CALL REGDEL
  E931    01 0204        C              LD   BC,0204H     ;LW-Status
  E934    CD E989        C              CALL WCOM
  E937    CD E99F        C              CALL DELAY
  E93A    DB 41          C              IN   A,(DFDC)     ;ST3
  E93C    CB 6F          C              BIT  5,A          ;LW ready?
  E93E    28 EE          C              JR   Z,ONLOOP     ;Drehzahl zu klein
  E940    C9             C              RET
                         C      ;
                         C      ;Motor ausschalten
                         C      ;-----------------
                         C      ;
  E941    E5             C      MOTOFF: PUSH HL
  E942    21 EAB3        C              LD   HL,STREG
  E945    CB 86          C              RES  0,(HL)
  E947    CB 9E          C              RES  3,(HL)
  E949    7E             C              LD   A,(HL)
  E94A    D3 44          C              OUT  (DL175),A
  E94C    E1             C              POP  HL
  E94D    C9             C              RET
                         C      ;
                         C      ;Precompensation einschalten
                         C      ;---------------------------
                         C      ;
  E94E    E5             C      PRECOM: PUSH HL           ;nicht genutzt
  E94F    21 EAB3        C              LD   HL,STREG
  E952    CB D6          C              SET  2,(HL)
  E954    7E             C              LD   A,(HL)
  E955    D3 44          C              OUT  (DL175),A
  E957    E1             C              POP  HL
  E958    C9             C              RET
                         C      ;
                         C      ;Laufwerksstatus pruefen
                         C      ;-----------------------
                         C      ;Kommando:04H+UNIT
                         C      ;
                         C      ;OUT:Statusregister 3
                         C      ;(FAULT,WP,RDY,TO,TS,HD,US1,US0)
                         C      ;
  E959    01 0204        C      SDS:    LD   BC,0204H
  E95C    CD E989        C              CALL WCOM         ;Kommando schreiben
  E95F    CD E9A6        C              CALL RBYTE        ;1 Byte lesen
  E962    C9             C              RET
	MACRO-80 3.44	09-Dec-81	PAGE	1-10


                         C      ;
                         C      ;Spur einstellen
                         C      ;---------------
                         C      ;Kommando:0FH+UNIT+TRACK
                         C      ;
  E963    3A EAB6        C      SEEK:   LD   A,(TRACK)    ;>Spur 80?
  E966    FE 80          C              CP   80H
  E968    D2 F2D5        C              JP   NC,DERROR
  E96B    01 030F        C              LD   BC,030FH
  E96E    CD E97F        C              CALL RDY
  E971    CD EA4F        C              CALL SENSE        ;Interruptst. pruefen
  E974    DB 40          C      SKBSY:  IN   A,(CFDC)
  E976    E6 0F          C              AND  0FH
  E978    20 FA          C              JR   NZ,SKBSY
  E97A    CB 60          C              BIT  4,B          ;>77 Spuren?
  E97C    20 E5          C              JR   NZ,SEEK
  E97E    C9             C              RET
                         C      ;
                         C      ;Kommando schreiben
                         C      ;------------------
                         C      ;
  E97F    C5             C      RDY:    PUSH BC           ;LW betriebsfaehig?
  E980    CD E959        C              CALL SDS          ;LW Status?
  E983    C1             C              POP  BC
  E984    CB 6F          C              BIT  5,A          ;Ready-Bit in Statreg.3
  E986    CA F2D5        C              JP   Z,DERROR     ;Fehlermeldung
  E989    2A EAB1        C      WCOM:   LD   HL,(FDCCOM)  ;Statustabelle
                         C      ;
                         C      ;IN: B - Anzahl der Kommandos
                         C      ;    C - 1. Kommando
                         C      ;
  E98C    CD E99F        C      WCOM1:  CALL DELAY
  E98F    DB 40          C              IN   A,(CFDC)
  E991    E6 C0          C              AND  0C0H
  E993    FE 80          C              CP   80H          ;RQM, DIO=OUT
  E995    20 F5          C              JR   NZ,WCOM1
  E997    79             C              LD   A,C
  E998    D3 41          C              OUT  (DFDC),A     ;Kommandoausgabe
  E99A    23             C              INC  HL
  E99B    4E             C              LD   C,(HL)
  E99C    10 EE          C              DJNZ WCOM1
  E99E    C9             C              RET
                         C      ;
                         C      ;Verzoegerung fuer Statusflag 8272
                         C      ;---------------------------------
                         C      ;
  E99F    C5             C      DELAY:  PUSH BC
  E9A0    06 0F          C              LD   B,0FH
  E9A2    10 FE          C      DEL1:   DJNZ DEL1
  E9A4    C1             C              POP  BC
  E9A5    C9             C              RET
                         C      ;
                         C      ;1 Byte lesen
                         C      ;------------
                         C      ;
  E9A6    CD E99F        C      RBYTE:  CALL DELAY
  E9A9    CD E9CB        C              CALL IRDY
  E9AC    DB 41          C              IN   A,(DFDC)
  E9AE    C9             C              RET
                         C      ;
	MACRO-80 3.44	09-Dec-81	PAGE	1-11


                         C      ;Lese 7 Resultat-Bytes
                         C      ;---------------------
                         C      ;
  E9AF    06 07          C      RRSLT:  LD   B,7
  E9B1    0E 41          C              LD   C,DFDC
  E9B3    21 EABE        C              LD   HL,RESLT
  E9B6    E5             C              PUSH HL
  E9B7    DB 40          C      RRSLT1: IN   A,(CFDC)
  E9B9    07             C              RLCA
  E9BA    D2 E9B7        C              JP   NC,RRSLT1
  E9BD    ED A2          C              INI
  E9BF    07             C              RLCA
  E9C0    D2 F2D5        C              JP   NC,DERROR
  E9C3    C2 E9B7        C              JP   NZ,RRSLT1
  E9C6    E1             C              POP  HL
  E9C7    7E             C              LD   A,(HL)
  E9C8    E6 C0          C              AND  0C0H
  E9CA    C9             C              RET
                         C      ;
                         C      ;Bereit fuer Dateneingabe?
                         C      ;-------------------------
                         C      ;
  E9CB    DB 40          C      IRDY:   IN   A,(CFDC)
  E9CD    07             C              RLCA
  E9CE    30 FB          C              JR   NC,IRDY
  E9D0    E6 80          C              AND  80H
  E9D2    07             C              RLCA
  E9D3    D8             C              RET  C            ;hier war frueher Schluss
  E9D4    CD E941        C              CALL MOTOFF
  E9D7    C3 F2D5        C              JP   DERROR
                         C      ;
                         C      ;Initialisierungstabelle
                         C      ;-----------------------
                         C      ;
  E9DA    E1             C      STAB:   DEFB 0E1H         ;XXXX-SRT, XXXX-HUT
  E9DB    33             C              DEFB 33H          ;XXXXXXX-HLT, X-ND
                         C      ;
                         C      ;Schreiben oder Lesen E*256 Bytes
                         C      ;--------------------------------
                         C      ;wird in RAM umgeladen
                         C      ;
  E9DC    06 00          C      RW:     LD   B,0
  E9DE    3A EABD        C              LD   A,(N2)
  E9E1    5F             C              LD   E,A
  E9E2    3A EAB3        C              LD   A,(STREG)
  E9E5    CB CF          C              SET  1,A
  E9E7    D3 44          C              OUT  (DL175),A    ;WAIT-Freigabe
  E9E9    DB 40          C      RW1:    IN   A,(CFDC)
  E9EB    07             C              RLCA
  E9EC    D2 E9E9        C              JP   NC,RW1
  E9EF    ED A2          C      MODE0:  INI
  E9F1    00             C              NOP
  E9F2    D3 43          C      RW2:    OUT  (AKWAIT),A   ;Aktivierung Wait
  E9F4    00             C              NOP
  E9F5    ED A2          C      MODE1:  INI
  E9F7    C2 E9F2        C              JP   NZ,RW2
  E9FA    1D             C              DEC  E
  E9FB    C2 E9F2        C              JP   NZ,RW2
  E9FE    3A EAB3        C              LD   A,(STREG)
  EA01    D3 44          C              OUT  (DL175),A    ;WAIT-Sperrung
	MACRO-80 3.44	09-Dec-81	PAGE	1-12


  EA03    C9             C              RET
                         C      ;
                         C      ;Resultatregister bis Fertigmeldung lesen
                         C      ;----------------------------------------
                         C      ;
  EA04    06 00          C      REGDEL: LD   B,0
  EA06    10 FE          C      ZEIT1:  DJNZ ZEIT1
  EA08    DB 40          C              IN   A,(CFDC)
  EA0A    FE 80          C              CP   80H
  EA0C    C8             C              RET  Z
  EA0D    DB 41          C              IN   A,(DFDC)
  EA0F    18 F3          C              JR   REGDEL
                         C      ;
                         C      ;Treiberinitialisierung U8272 + Laufwerke
                         C      ;----------------------------------------
                         C      ;
  EA11    3A F438        C      INITFL: LD   A,(DRIVE)    ;Floppy initialisieren
  EA14    B7             C              OR   A            ;Drive_0 oder Drive_1 seletiert?
  EA15    C8             C              RET  Z            ;nein
  EA16    3D             C              DEC  A
  EA17    20 08          C              JR   NZ,INITF1    ;--> Drive_1
  EA19    3A EAD0        C              LD   A,(FLFLAG)
  EA1C    CB 47          C              BIT  0,A          ;Drive_0 bereits initialisiert?
  EA1E    C0             C              RET  NZ           ;ja
  EA1F    18 06          C              JR   INITF2
  EA21    3A EAD0        C      INITF1: LD   A,(FLFLAG)
  EA24    CB 4F          C              BIT  1,A          ;Drive_1 bereits initialisiert?
  EA26    C0             C              RET  NZ           ;ja
  EA27    CD E90E        C      INITF2: CALL MOTON
  EA2A    21 E9D9        C              LD   HL,STAB-1    ;Parameter laden
  EA2D    01 0303        C              LD   BC,0303H     ;3 Kommandos
  EA30    CD E98C        C              CALL WCOM1        ;03H+0E1H+33H
  EA33    01 0207        C      INITF3: LD   BC,0207H     ;Spur 0 einstellen
  EA36    CD E97F        C              CALL RDY          ;07H+UNIT --> Drive_0 / Drive_1
  EA39    CD EA4F        C              CALL SENSE
  EA3C    CB 60          C              BIT  4,B          ;Spur 0 erreicht?
  EA3E    20 F3          C              JR   NZ,INITF3
  EA40    CD E941        C              CALL MOTOFF
  EA43    3A F438        C              LD   A,(DRIVE)    ;0x01 oder 0x02
  EA46    4F             C              LD   C,A
  EA47    3A EAD0        C              LD   A,(FLFLAG)
  EA4A    B1             C              OR   C
  EA4B    32 EAD0        C              LD   (FLFLAG),A   ;Init.-Flag setzen
  EA4E    C9             C              RET
                         C      ;
                         C      ;Pruefe Interruptstatus
                         C      ;----------------------
                         C      ;
  EA4F    01 0108        C      SENSE:  LD   BC,0108H
  EA52    CD E989        C              CALL WCOM         ;Kommando schreiben
  EA55    CD E9A6        C              CALL RBYTE        ;Resultatregister 0
  EA58    47             C              LD   B,A
  EA59    FE 80          C              CP   80H
  EA5B    C4 E9A6        C              CALL NZ,RBYTE     ;PCN holen
  EA5E    CB 68          C              BIT  5,B          ;SEEK Ende?
  EA60    28 ED          C              JR   Z,SENSE
  EA62    C9             C              RET
                         C      ;
                         C      ;Sector schreiben
                         C      ;----------------
	MACRO-80 3.44	09-Dec-81	PAGE	1-13


                         C      ;Sector in (SECTR)
                         C      ;Spur in (TRACK)
                         C      ;akt. LW in (UNIT)
                         C      ;Ziel-/Quelladr. = FDMA
                         C      ;
  EA63    11             C      W8272:  DEFB 11H          ;LD DE,...
  EA64    ED A3          C              OUTI
  EA66    3E 45          C              LD   A,45H        ;Schreibkommando
  EA68    18 05          C              JR   RWIT
                         C      ;
                         C      ;Sector lesen
                         C      ;------------
                         C      ;
  EA6A    11             C      R8272:  DEFB 11H          ;LD DE,...
  EA6B    ED A2          C              INI
  EA6D    3E 46          C              LD   A,46H        ;Lesekommando
  EA6F    32 EAB4        C      RWIT:   LD   (CTAB),A
  EA72    ED 53 E9EF     C              LD   (MODE0),DE
  EA76    ED 53 E9F5     C              LD   (MODE1),DE
  EA7A    CD E90E        C              CALL MOTON
  EA7D    CD E963        C              CALL SEEK
  EA80    06 0A          C              LD   B,10         ;10 Versuche
  EA82    C5             C      RWOP:   PUSH BC
  EA83    06 09          C              LD   B,9          ;9 Kommandobytes
  EA85    3A EAB4        C              LD   A,(CTAB)
  EA88    4F             C              LD   C,A
  EA89    CD E97F        C              CALL RDY          ;Kommandoausgabe
  EA8C    21 EAD1        C              LD   HL,FDMA
  EA8F    0E 41          C              LD   C,DFDC       ;Kanal
  EA91    CD E9DC        C              CALL RW
                         C      ;
                         C      ;Ende-Impuls
                         C      ;
  EA94    3A EAB3        C              LD   A,(STREG)
  EA97    CB E7          C              SET  4,A
  EA99    D3 44          C              OUT  (DL175),A
  EA9B    CD E9AF        C              CALL RRSLT
  EA9E    C1             C              POP  BC
  EA9F    28 04          C              JR   Z,RWEND
  EAA1    10 DF          C              DJNZ RWOP
  EAA3    3E 01          C              LD   A,1          ;ERROR
  EAA5    21 EACF        C      RWEND:  LD   HL,RWTEST
  EAA8    B6             C              OR   (HL)
  EAA9    77             C              LD   (HL),A
  EAAA    CD E941        C              CALL MOTOFF
  EAAD    C9             C              RET
                         C      ;
  EAAE    01             C      SECTOR: DEFB 1
  EAAF    0080           C      DMA:    DEFW 0080H
  EAB1    EAB4           C      FDCCOM: DEFW CTAB
  EAB3    00             C      STREG:  DEFB 0            ;Statusregister fuer DL175
  EAB4    FF             C      CTAB:   DEFB 0FFH
  EAB5    00             C      UNIT:   DEFB 0            ;akt. LW
  EAB6    00             C      TRACK:  DEFB 0
  EAB7    00             C      HEAD:   DEFB 0
  EAB8    01             C      SECTR:  DEFB 1
  EAB9    03             C      N:      DEFB 3            ;N=3 --> 1Kbyte
  EABA    05             C      EOT:    DEFB 5            ;5 Sektoren je Spur
  EABB    32             C      GPL:    DEFB 32H          ;Luecke
  EABC    FF             C      DTL:    DEFB 0FFH
	MACRO-80 3.44	09-Dec-81	PAGE	1-14


  EABD    04             C      N2:     DEFB 4
  EABE                   C      RESLT:  DEFS 7,0          ;Resultattabelle f. FDC
  EAC5                   C      CTAB2:  DEFS 9,0
  EACE                   C      BLTEST: DEFS 1,0          ;Host-Sector schreiben
  EACF                   C      RWTEST: DEFS 1,0          ;fuer Fehlermeldungen
  EAD0    00             C      FLFLAG: DEFB 0            ;Init.-Flag fuer Floppy
  EAD1                   C      FDMA:   DEFS 400H,0       ;Host-Sector
                         C      ;
                                ENDIF
                                ;
                                        .PRINTX '--> RAMDISK'
                         C      $INCLUDE RAMDISK.INC
                         C      ;       *************************
                         C      ;       *                       *
                         C      ;       * Praecitronic RAM-Disk *
                         C      ;       *                       *
                         C      ;       *************************
                         C      ;
                         C      ;10.04.2024
                         C      ;
                         C      ;Die RAM-Disk hat eine Organisation von 256 Tracks
                         C      ;und 64 Sectoren/Track (8K / Track).
                         C      ;Track 0 ist fuer CCP + BDOS reserviert (8K Systemtrack).
                         C      ;
  00E0                   C      RDADR   EQU  0E0H         ;Grund-Adresse der RAM-Disk
                         C      ;
  EED1                   C      RDMERK: DEFS 4,0          ;4 Merkzellen fuer den RAM-Disk Test
  EED5    00             C      RDSIZE: DEFB 0            ;RD-Size: 0=256K 1=512K 2=1024K 3=2048K
                         C      ;
                         C      ; RAM-Disk lesen
                         C      ; --------------
                         C      ;
  EED6    CD EEE4        C      RDRDSK: CALL RDARI
  EED9    ED B2          C              INIR
  EEDB    AF             C              XOR  A
  EEDC    C9             C              RET
                         C      ;
                         C      ; RAM-Disk schreiben
                         C      ; ------------------
                         C      ;
  EEDD    CD EEE4        C      WRRDSK: CALL RDARI
  EEE0    ED B3          C              OTIR
  EEE2    AF             C              XOR  A
  EEE3    C9             C              RET
                         C      ;
                         C      ; Disk-Adresse bestimmen
                         C      ; ----------------------
                         C      ;
  EEE4    3A EAB6        C      RDARI:  LD   A,(TRACK)    ;TTTTTTTT
  EEE7    6F             C              LD   L,A
  EEE8    3A EAAE        C              LD   A,(SECTOR)   ;00SSSSSS
  EEEB    A7             C              AND  A
  EEEC    CA F2D5        C              JP   Z,DERROR     ;Zugriff auf Sektor 0
  EEEF    5F             C              LD   E,A
  EEF0    1D             C              DEC  E            ;CP/A beginnt mit Sektor 1
  EEF1    AF             C              XOR  A
  EEF2    67             C              LD   H,A
  EEF3    57             C              LD   D,A
  EEF4    29             C              ADD  HL,HL
  EEF5    29             C              ADD  HL,HL
	MACRO-80 3.44	09-Dec-81	PAGE	1-15


  EEF6    29             C              ADD  HL,HL
  EEF7    29             C              ADD  HL,HL
  EEF8    29             C              ADD  HL,HL
  EEF9    29             C              ADD  HL,HL        ;00TTTTTT TT000000
  EEFA    19             C              ADD  HL,DE        ;00TTTTTT TTSSSSSS
  EEFB    CB 1C          C              RR   H            ;000TTTTT
  EEFD    CB 1D          C              RR   L            ;TTTSSSSS
  EEFF    CB 1F          C              RR   A            ;S0000000
  EF01    D3 E7          C              OUT  (RDADR+7),A  ;NWT
  EF03    7D             C              LD   A,L
  EF04    D3 E6          C              OUT  (RDADR+6),A  ;HWT
  EF06    7C             C              LD   A,H
  EF07    4F             C              LD   C,A          ;Akku sichern
  EF08    CB 3F          C              SRL  A            ;0 --> A7 --> A0 --> CY
  EF0A    CB 3F          C              SRL  A
  EF0C    D3 E5          C              OUT  (RDADR+5),A  ;XWT
  EF0E    79             C              LD   A,C          ;Akku zurueck
  EF0F    E6 03          C              AND  3
  EF11    F6 E0          C              OR   RDADR        ;Grundadresse der RAM-Disk
  EF13    4F             C              LD   C,A
  EF14    06 80          C              LD   B,128
  EF16    2A EAAF        C              LD   HL,(DMA)
  EF19    C9             C              RET
                         C      ;
                         C      ; RAM-DISK formatieren
                         C      ; --------------------
                         C      ;
  EF1A    21 F028        C      INITRD: LD   HL,RDTXT     ;RAM-Disk formatieren?
  EF1D    CD F2E7        C              CALL OUTTXT
  EF20    CD F1D8        C              CALL CONIN
  EF23    CB AF          C              RES  5,A          ;UPCASE
  EF25    FE 4A          C              CP   "J"
  EF27    28 07          C              JR   Z,INITR1
  EF29    21 F04A        C              LD   HL,NOTXT     ;nein
  EF2C    CD F2E7        C              CALL OUTTXT
  EF2F    C9             C              RET
                         C      ;
  EF30    21 F046        C      INITR1: LD   HL,YESTXT    ;ja
  EF33    CD F2E7        C              CALL OUTTXT
  EF36    21 0080        C              LD   HL,0080H
  EF39    22 EAAF        C              LD   (DMA),HL
  EF3C    36 E5          C              LD   (HL),0E5H    ;DMA mit 0E5H auffuellen
  EF3E    11 0081        C              LD   DE,0081H
  EF41    01 007F        C              LD   BC,07FH
  EF44    ED B0          C              LDIR
  EF46    3E 40          C              LD   A,64         ;64 Sektoren
  EF48    32 EAAE        C              LD   (SECTOR),A
  EF4B    3A EED5        C              LD   A,(RDSIZE)   ;RD-Size: 0=256K 1=512K 2=1024K 3=2048K
  EF4E    3C             C              INC  A
  EF4F    47             C              LD   B,A          ;B-Reg.: 1=256K 2=512K 3=1024K 4=2048K
  EF50    3E 10          C              LD   A,16         ;16 Tracks = 128K
  EF52    CB 27          C      INITR2: SLA  A            ;A = A * 2
  EF54    10 FC          C              DJNZ INITR2       ;1-4 Durchlaeufe, je nach RDSIZE
  EF56    21 F04E        C              LD   HL,TICK      ;Ausgabe "-"
  EF59    CD F2E7        C              CALL OUTTXT
  EF5C    21 EAB6        C              LD   HL,TRACK
  EF5F    77             C              LD   (HL),A       ;Anzahl der Tracks, bei 2048K ist A=0
  EF60    35             C      INITR3: DEC  (HL)         ;Track--
  EF61    7E             C              LD   A,(HL)
  EF62    E6 1F          C              AND  31           ;jeder 32. Track, also alle 256K
	MACRO-80 3.44	09-Dec-81	PAGE	1-16


  EF64    20 06          C              JR   NZ,INITR4
  EF66    21 F04E        C              LD   HL,TICK      ;Ausgabe "-"
  EF69    CD F2E7        C              CALL OUTTXT
  EF6C    CD EEDD        C      INITR4: CALL WRRDSK
  EF6F    21 EAAE        C              LD   HL,SECTOR
  EF72    35             C              DEC  (HL)         ;Sektor--
  EF73    20 F7          C              JR   NZ,INITR4
  EF75    36 40          C              LD   (HL),64      ;64 Sektoren
  EF77    21 EAB6        C              LD   HL,TRACK
  EF7A    34             C              INC  (HL)
  EF7B    35             C              DEC  (HL)         ;Track = 0 ?
  EF7C    20 E2          C              JR   NZ,INITR3
                         C              IFDEF FLOPPY
  EF7E    CD EF88        C              CALL CCPWR        ;CCP + BDOS --> RAM-Disk
                         C              ENDIF
  EF81    21 F050        C              LD   HL,INITOK
  EF84    CD F2E7        C              CALL OUTTXT
  EF87    C9             C              RET
                         C      ;
                         C      ; CCP + BDOS in Track 0/255 schreiben (44 Sektoren)
                         C      ; -----------------------------------
                         C      ;
                         C      IFDEF FLOPPY
  EF88    AF             C      CCPWR:  XOR  A
                         C      ELSE
                         C      CCPWR:  LD   A,255
                         C      ENDIF
  EF89    32 EAB6        C              LD   (TRACK),A
  EF8C    3E 01          C              LD   A,1
  EF8E    32 EAAE        C              LD   (SECTOR),A
  EF91    21 D000        C              LD   HL,CCP       ;CCP-Startadresse
  EF94    22 EAAF        C      CCPWR1: LD   (DMA),HL
  EF97    E5             C              PUSH HL
  EF98    CD EEDD        C              CALL WRRDSK       ;RAM-Disk schreiben
  EF9B    21 EAAE        C              LD   HL,SECTOR
  EF9E    34             C              INC  (HL)         ;Sektor++
  EF9F    E1             C              POP  HL
  EFA0    01 0080        C              LD   BC,128
  EFA3    09             C              ADD  HL,BC
                         C      IFDEF FLOPPY
  EFA4    3E E5          C              LD   A,0E5H
                         C      ELSE
                         C              LD   A,0F5H
                         C      ENDIF
  EFA6    BC             C              CP   H
  EFA7    30 EB          C              JR   NC,CCPWR1    ;0E600H/0F600H noch nicht erreicht
  EFA9    C9             C              RET
                         C      ;
                         C      ; CCP + BDOS von Track 0/255 lesen (44 Sektoren)
                         C      ; --------------------------------
                         C      ;
                         C      IFDEF FLOPPY
  EFAA    AF             C      CCPRD:  XOR  A
                         C      ELSE
                         C      CCPRD:  LD   A,255
                         C      ENDIF
  EFAB    32 EAB6        C              LD   (TRACK),A
  EFAE    3E 01          C              LD   A,1
  EFB0    32 EAAE        C              LD   (SECTOR),A
  EFB3    21 D000        C              LD   HL,CCP       ;CCP-Startadresse
	MACRO-80 3.44	09-Dec-81	PAGE	1-17


  EFB6    22 EAAF        C      CCPRD1: LD   (DMA),HL
  EFB9    E5             C              PUSH HL
  EFBA    CD EED6        C              CALL RDRDSK       ;RAM-Disk lesen
  EFBD    21 EAAE        C              LD   HL,SECTOR
  EFC0    34             C              INC  (HL)         ;Sektor++
  EFC1    E1             C              POP  HL
  EFC2    01 0080        C              LD   BC,128
  EFC5    09             C              ADD  HL,BC
                         C      IFDEF FLOPPY
  EFC6    3E E5          C              LD   A,0E5H
                         C      ELSE
                         C              LD   A,0F5H
                         C      ENDIF
  EFC8    BC             C              CP   H
  EFC9    30 EB          C              JR   NC,CCPRD1    ;0E600H/0F600H noch nicht erreicht
  EFCB    C9             C              RET
                         C      ;
                         C      ; Test der RAM-Disk - Size (256 / 512 / 1024 / 2048 KByte)
                         C      ; ------------------------
                         C      ;
  EFCC    AF             C      RDTEST: XOR  A            ;Kapazitaet der RAM-Disk testen
  EFCD    D3 E6          C              OUT  (RDADR+6),A  ;H-Adresse ruecksetzen
  EFCF    0E E0          C              LD   C,RDADR      ;Test erfolgt in der 1. RAM-Bank
                         C      ;
                         C      ; Inhalte der 4 RAM-Testzellen sichern
                         C      ;
  EFD1    21 EED1        C              LD   HL,RDMERK    ;Merkzellen im RAM
  EFD4    06 04          C              LD   B,4          ;4 Durchlaeufe
  EFD6    16 04          C              LD   D,4          ;Startwert Extended-Adresse
  EFD8    AF             C      RDTST1: XOR  A
  EFD9    D3 E7          C              OUT  (RDADR+7),A  ;L-Adresse ruecksetzen
  EFDB    7A             C              LD   A,D
  EFDC    D3 E5          C              OUT  (RDADR+5),A  ;Extended-Adresse auswaehlen
  EFDE    ED 78          C              IN   A,(C)
  EFE0    77             C              LD   (HL),A       ;Daten aus der RAM-Disk sichern
  EFE1    23             C              INC  HL           ;Merkzelle++
  EFE2    CB 3A          C              SRL  D            ;0 --> D7 --> D0 --> CY
  EFE4    10 F2          C              DJNZ RDTST1
                         C      ;
                         C      ; 4 Testwerte in die RAM-Disk schreiben
                         C      ;
  EFE6    06 04          C              LD   B,4          ;4 Durchlaeufe
  EFE8    16 04          C              LD   D,4          ;Startwert Extended-Adresse
  EFEA    AF             C      RDTST2: XOR  A
  EFEB    D3 E7          C              OUT  (RDADR+7),A  ;L-Adresse ruecksetzen
  EFED    7A             C              LD   A,D
  EFEE    D3 E5          C              OUT  (RDADR+5),A  ;Extended-Adresse auswaehlen
  EFF0    ED 79          C              OUT  (C),A        ;Testwert in die RAM-Disk schreiben
  EFF2    CB 3A          C              SRL  D            ;0 --> D7 --> D0 --> CY
  EFF4    10 F4          C              DJNZ RDTST2
                         C      ;
                         C      ;Tabelle der Test-Werte (mit *...* sind die zu testenden Werte):
                         C      ;
                         C      ;           RAM-Disk-Size =   256K   512K  1024K  2048K
                         C      ;Extended-Adresse=00000100B    0      0      0     *4*
                         C      ;Extended-Adresse=00000010B    0      0     *2*     2
                         C      ;Extended-Adresse=00000001B    0     *1*     1      1
                         C      ;Extended-Adresse=00000000B   *0*     0      0      0
                         C      ;
                         C      ; Groesse der RAM-Disk bestimmen
	MACRO-80 3.44	09-Dec-81	PAGE	1-18


                         C      ;
  EFF6    06 04          C              LD   B,4          ;4 Durchlaeufe
  EFF8    16 04          C              LD   D,4          ;Startwert Extended-Adresse
  EFFA    AF             C      RDTST3: XOR  A
  EFFB    D3 E7          C              OUT  (RDADR+7),A  ;L-Adresse ruecksetzen
  EFFD    7A             C              LD   A,D
  EFFE    D3 E5          C              OUT  (RDADR+5),A  ;Extended-Adresse auswaehlen
  F000    ED 78          C              IN   A,(C)
  F002    BA             C              CP   D
  F003    28 07          C              JR   Z,RDTST4     ;2048(B=4),1024(B=3),512(B=2),256(B=1)
  F005    CB 3A          C              SRL  D            ;0 --> D7 --> D0 --> CY
  F007    10 F1          C              DJNZ RDTST3
  F009    C3 F2D5        C              JP   DERROR       ;Fehler: hier stimmt was nicht!
                         C      ;
  F00C    21 EED5        C      RDTST4: LD   HL,RDSIZE
  F00F    05             C              DEC  B
  F010    70             C              LD   (HL),B       ;RD-Size: 0=256K 1=512K 2=1024K 3=2048K
                         C      ;
                         C      ; gesicherte Daten in die RAM-Disk zurueckschreiben
                         C      ; 
  F011    21 EED4        C              LD   HL,RDMERK+3  ;Merkzellen RAM (letzter Eintrag)
  F014    04             C              INC  B            ;1 bis 4 Durchlaeufe, je nach RDSIZE
  F015    16 01          C              LD   D,1          ;Startwert Ext.-Adr. (1 Bit n. rechts)
  F017    AF             C      RDTST5: XOR  A
  F018    D3 E7          C              OUT  (RDADR+7),A  ;L-Adresse ruecksetzen
  F01A    7A             C              LD   A,D
  F01B    CB 3F          C              SRL  A            ;0 --> A7 --> A0 --> CY
  F01D    D3 E5          C              OUT  (RDADR+5),A  ;Extended-Adresse auswaehlen
  F01F    7E             C              LD   A,(HL)
  F020    ED 79          C              OUT  (C),A        ;urspruengliche Daten zurueckschreiben
  F022    2B             C              DEC  HL
  F023    CB 22          C              SLA  D            ;CY <-- D7 <-- D0 <-- 0
  F025    10 F0          C              DJNZ RDTST5       ;WICHTIG: nicht mehr als notwendig
  F027    C9             C              RET               ;in die RAM-Disk zurueckschreiben!
                         C      ;
  F028    52 41 4D 2D    C      RDTXT:  DEFM 'RAM-Disk formatieren? (J/N): '
  F02C    44 69 73 6B    C      
  F030    20 66 6F 72    C      
  F034    6D 61 74 69    C      
  F038    65 72 65 6E    C      
  F03C    3F 20 28 4A    C      
  F040    2F 4E 29 3A    C      
  F044    20             C      
  F045    00             C              DEFB 00H
  F046    4A             C      YESTXT: DEFM 'J'
  F047    0D 0A 00       C              DEFB 0DH,0AH,00H
  F04A    4E             C      NOTXT:  DEFM 'N'
  F04B    0D 0A 00       C              DEFB 0DH,0AH,00H
  F04E    2D 00          C      TICK:   DEFB 2DH,00H
  F050    3E 20 49 6E    C      INITOK: DEFM '> Init. O.K.'
  F054    69 74 2E 20    C      
  F058    4F 2E 4B 2E    C      
  F05C    0D 0A 00       C              DEFB 0DH,0AH,00H
                         C      ;
                                ;
                                        .PRINTX '--> CONSOLE'
                         C      $INCLUDE CONSOLE.INC
                         C      ;       ***************************
                         C      ;       *                         *
                         C      ;       * CONOUT, CONIN und CONST *
	MACRO-80 3.44	09-Dec-81	PAGE	1-19


                         C      ;       *                         *
                         C      ;       ***************************
                         C      ;
                         C      ;06.07.2022
                         C      ;
  005F                   C      CURSOR  EQU  5FH          ;Cursorsymbol "_"
                         C      ;
  F05F    F3             C      CONOUT: DI
  F060    ED 73 F5DD     C              LD   (SAVSTK),SP
  F064    31 F65D        C              LD   SP,BIOSTK
  F067    FB             C              EI
  F068    F5             C              PUSH AF
  F069    C5             C              PUSH BC
  F06A    D5             C              PUSH DE
  F06B    E5             C              PUSH HL
  F06C    3E 00          C              LD   A,AC1MOD
  F06E    D3 1E          C              OUT  (MAP),A
  F070    2A F2A2        C              LD   HL,(CURSP)
  F073    3A F2A6        C              LD   A,(MERKUR)
  F076    77             C              LD   (HL),A
  F077    AF             C              XOR  A
  F078    21 F2A5        C              LD   HL,ESCCNT    ;Escapesequenz ?
  F07B    B6             C              OR   (HL)
  F07C    28 2D          C              JR   Z,VERGL      ;Nein
  F07E    CB B9          C              RES  7,C
  F080    35             C              DEC  (HL)
  F081    28 05          C              JR   Z,DIPOS      ;C --> Spaltennummer
  F083    2B             C              DEC  HL
  F084    71             C              LD   (HL),C       ;C --> Zeilennummer
  F085    C3 F1C0        C              JP   COEND
                         C      ;
  F088    2B             C      DIPOS:  DEC  HL
  F089    7E             C              LD   A,(HL)       ;Zeilennummer
  F08A    E6 1F          C              AND  1FH
  F08C    5F             C              LD   E,A
  F08D    16 00          C              LD   D,0          ;Zeilennummer --> DE
  F08F    79             C              LD   A,C          ;Spaltennummer
  F090    E6 3F          C              AND  3FH
  F092    6F             C              LD   L,A
  F093    26 00          C              LD   H,0          ;Spaltennummer --> HL
  F095    06 06          C              LD   B,6
  F097    CB 23          C      DIPOS1: SLA  E
  F099    CB 12          C              RL   D
  F09B    10 FA          C              DJNZ DIPOS1
  F09D    19             C              ADD  HL,DE
  F09E    EB             C              EX   DE,HL
  F09F    21 17FF        C              LD   HL,17FFH
  F0A2    A7             C              AND  A
  F0A3    ED 52          C              SBC  HL,DE
  F0A5    22 F2A2        C              LD   (CURSP),HL
  F0A8    C3 F1C0        C              JP   COEND
                         C      ;
  F0AB    2A F2A2        C      VERGL:  LD   HL,(CURSP)
  F0AE    79             C              LD   A,C
  F0AF    FE 82          C              CP   82H
  F0B1    CA F17E        C              JP   Z,CUON       ;Cursor einschalten
  F0B4    FE 83          C              CP   83H
  F0B6    CA F190        C              JP   Z,CUOFF      ;Cursor abschalten
  F0B9    CB BF          C              RES  7,A
  F0BB    FE 1B          C              CP   1BH
	MACRO-80 3.44	09-Dec-81	PAGE	1-20


  F0BD    28 58          C              JR   Z,ESCAPE     ;ESC
  F0BF    FE 01          C              CP   1
  F0C1    28 5C          C              JR   Z,CUHOME     ;HOME
  F0C3    FE 07          C              CP   7
  F0C5    28 61          C              JR   Z,BEEP       ;BEEP
  F0C7    FE 0A          C              CP   0AH
  F0C9    28 6F          C              JR   Z,LF         ;LINEFEED
  F0CB    FE 0D          C              CP   0DH
  F0CD    28 2A          C              JR   Z,CR         ;CR
  F0CF    FE 15          C              CP   15H
  F0D1    28 6F          C              JR   Z,CURECH     ;Cursor nach rechts
  F0D3    FE 16          C              CP   16H
  F0D5    CA F167        C              JP   Z,DELEND     ;loescht Cu. -> ZE
  F0D8    FE 18          C              CP   18H
  F0DA    CA F173        C              JP   Z,DELLIN     ;loescht zeile,Cu <-
  F0DD    FE 1A          C              CP   1AH
  F0DF    28 6E          C              JR   Z,CURSUP     ;Cursor eine Z. hoch
  F0E1    FE 7F          C              CP   7FH
  F0E3    28 60          C              JR   Z,DEL        ;DELETE
  F0E5    FE 14          C              CP   14H
  F0E7    28 74          C              JR   Z,CLRTES     ;Clear to end screen
  F0E9    FE 0C          C              CP   0CH
  F0EB    28 16          C              JR   Z,CLS        ;CLS
  F0ED    FE 08          C              CP   8
  F0EF    28 0F          C              JR   Z,BS         ;BACKSPACE
  F0F1    FE 20          C              CP   20H
  F0F3    DA F1C0        C              JP   C,COEND
  F0F6    C3 F19B        C              JP   OUTZEI       ;Ausgabe auf BS
                         C      ;
  F0F9    7D             C      CR:     LD   A,L
  F0FA    F6 3F          C              OR   3FH
  F0FC    6F             C              LD   L,A
  F0FD    C3 F19D        C              JP   COEND1
                         C      ;
  F100    23             C      BS:     INC  HL
  F101    18 50          C              JR   UP1
                         C      ;
  F103    3E 20          C      CLS:    LD   A,20H
  F105    21 1000        C              LD   HL,1000H
  F108    11 1001        C              LD   DE,1001H
  F10B    01 07FF        C              LD   BC,07FFH
  F10E    77             C              LD   (HL),A
  F10F    ED B0          C              LDIR
  F111    22 F2A2        C              LD   (CURSP),HL
  F114    C3 F1C0        C              JP   COEND
                         C      ;
  F117    3E 02          C      ESCAPE: LD   A,2          ;2 Argumente folgen
  F119    32 F2A5        C              LD   (ESCCNT),A
  F11C    C3 F1C0        C              JP   COEND
                         C      ;
  F11F    21 17FF        C      CUHOME: LD   HL,17FFH
  F122    22 F2A2        C              LD   (CURSP),HL
  F125    C3 F1C0        C              JP   COEND
                         C      ;
  F128    0E FF          C      BEEP:   LD   C,0FFH
  F12A    06 90          C      BEEP0:  LD   B,90H
  F12C    10 FE          C      BEEP1:  DJNZ BEEP1
  F12E    DB 05          C              IN   A,(PIO1BD)
  F130    EE 41          C              XOR  41H          ;PB0 und PB6 ---> Piep
  F132    D3 05          C              OUT  (PIO1BD),A
	MACRO-80 3.44	09-Dec-81	PAGE	1-21


  F134    0D             C              DEC  C
  F135    20 F3          C              JR   NZ,BEEP0
  F137    C3 F1C0        C              JP   COEND
                         C      ;
  F13A    11 0040        C      LF:     LD   DE,40H
  F13D    A7             C              AND  A
  F13E    ED 52          C              SBC  HL,DE
  F140    18 5B          C              JR   COEND1
                         C      ;
  F142    2B             C      CURECH: DEC  HL
  F143    18 58          C              JR   COEND1
                         C      ;
  F145    23             C      DEL:    INC  HL
  F146    3E 18          C              LD   A,18H
  F148    BC             C              CP   H
  F149    28 75          C              JR   Z,COEND
  F14B    36 20          C              LD   (HL),20H
  F14D    18 4E          C              JR   COEND1
                         C      ;
  F14F    11 0040        C      CURSUP: LD   DE,40H
  F152    19             C              ADD  HL,DE
  F153    3E 18          C      UP1:    LD   A,18H
  F155    BC             C              CP   H
  F156    28 68          C              JR   Z,COEND
  F158    22 F2A2        C              LD   (CURSP),HL
  F15B    18 63          C              JR   COEND
                         C      ;
  F15D    3E 0F          C      CLRTES: LD   A,0FH
  F15F    36 20          C      SPACE1: LD   (HL),20H
  F161    2B             C              DEC  HL
  F162    BC             C              CP   H
  F163    20 FA          C              JR   NZ,SPACE1
  F165    18 59          C              JR   COEND
                         C      ;
  F167    7D             C      DELEND: LD   A,L
  F168    E6 3F          C              AND  3FH
  F16A    47             C              LD   B,A
  F16B    04             C              INC  B
  F16C    36 20          C      SPACE2: LD   (HL),20H
  F16E    2B             C              DEC  HL
  F16F    10 FB          C              DJNZ SPACE2
  F171    18 4D          C              JR   COEND
                         C      ;
  F173    7D             C      DELLIN: LD   A,L
  F174    F6 3F          C              OR   3FH
  F176    6F             C              LD   L,A
  F177    22 F2A2        C              LD   (CURSP),HL
  F17A    06 40          C              LD   B,40H
  F17C    18 EE          C              JR   SPACE2
                         C      ;
  F17E    3E 36          C      CUON:   LD   A,36H        ;LD (HL),...
  F180    21 F1C7        C              LD   HL,ON1
  F183    77             C              LD   (HL),A
  F184    23             C              INC  HL
  F185    36 5F          C              LD   (HL),CURSOR
  F187    21 F1EB        C              LD   HL,COIN1
  F18A    77             C              LD   (HL),A
  F18B    23             C              INC  HL
  F18C    36 5F          C              LD   (HL),CURSOR
  F18E    18 30          C              JR   COEND
	MACRO-80 3.44	09-Dec-81	PAGE	1-22


                         C      ;
  F190    21 0000        C      CUOFF:  LD   HL,0
  F193    22 F1C7        C              LD   (ON1),HL
  F196    22 F1EB        C              LD   (COIN1),HL
  F199    18 25          C              JR   COEND
                         C      ;
  F19B    77             C      OUTZEI: LD   (HL),A
  F19C    2B             C              DEC  HL
  F19D    EB             C      COEND1: EX   DE,HL
  F19E    21 0FFF        C              LD   HL,0FFFH
  F1A1    A7             C              AND  A
  F1A2    ED 52          C              SBC  HL,DE
  F1A4    EB             C              EX   DE,HL
  F1A5    22 F2A2        C              LD   (CURSP),HL
  F1A8    38 16          C              JR   C,COEND
  F1AA    21 17BF        C              LD   HL,17BFH
  F1AD    11 17FF        C              LD   DE,17FFH
  F1B0    01 07C0        C              LD   BC,07C0H
  F1B3    ED B8          C              LDDR              ;Bild rollen
  F1B5    ED 53 F2A2     C              LD   (CURSP),DE
  F1B9    EB             C              EX   DE,HL
  F1BA    2C             C              INC  L
  F1BB    2D             C      SPACE3: DEC  L
  F1BC    36 20          C              LD   (HL),20H
  F1BE    20 FB          C              JR   NZ,SPACE3
  F1C0    2A F2A2        C      COEND:  LD   HL,(CURSP)
  F1C3    7E             C              LD   A,(HL)
  F1C4    32 F2A6        C              LD   (MERKUR),A
  F1C7    36 5F          C      ON1:    LD   (HL),CURSOR
  F1C9    3E 01          C              LD   A,CPMMOD
  F1CB    D3 1E          C              OUT  (MAP),A
  F1CD    E1             C              POP  HL
  F1CE    D1             C              POP  DE
  F1CF    C1             C              POP  BC
  F1D0    F1             C              POP  AF
  F1D1    F3             C              DI
  F1D2    ED 7B F5DD     C              LD   SP,(SAVSTK)
  F1D6    FB             C              EI
  F1D7    C9             C              RET
                         C      ;
  F1D8    F3             C      CONIN:  DI
  F1D9    ED 73 F5DD     C              LD   (SAVSTK),SP
  F1DD    31 F65D        C              LD   SP,BIOSTK
  F1E0    FB             C              EI
  F1E1    3E 00          C              LD   A,AC1MOD
  F1E3    D3 1E          C              OUT  (MAP),A
  F1E5    C5             C              PUSH BC
  F1E6    D5             C              PUSH DE
  F1E7    E5             C              PUSH HL
  F1E8    2A F2A2        C              LD   HL,(CURSP)
  F1EB    36 5F          C      COIN1:  LD   (HL),CURSOR
  F1ED    01 6000        C      COIN2:  LD   BC,6000H     ;Kursorblinkfrequenz
  F1F0    3A E67B        C      COIN3:  LD   A,(TZ)       ;Tastaturzaehler?
  F1F3    B7             C              OR   A
  F1F4    20 10          C              JR   NZ,KEY       ;Taste gedrueckt
  F1F6    0B             C              DEC  BC
  F1F7    78             C              LD   A,B
  F1F8    B1             C              OR   C
  F1F9    20 F5          C              JR   NZ,COIN3     ;Warteschleife
  F1FB    3E 5F          C              LD   A,CURSOR
	MACRO-80 3.44	09-Dec-81	PAGE	1-23


  F1FD    BE             C              CP   (HL)
  F1FE    20 EB          C              JR   NZ,COIN1
  F200    3A F2A6        C              LD   A,(MERKUR)
  F203    77             C              LD   (HL),A
  F204    18 E7          C              JR   COIN2
                         C      ;
  F206    3A F2A6        C      KEY:    LD   A,(MERKUR)   ;Taste gedrueckt
  F209    77             C              LD   (HL),A       ;Cursor weg
  F20A    21 E67D        C              LD   HL,TZ+2
  F20D    56             C              LD   D,(HL)
  F20E    2B             C              DEC  HL
  F20F    5E             C              LD   E,(HL)
  F210    34             C              INC  (HL)
  F211    CB 9E          C              RES  3,(HL)
  F213    2B             C              DEC  HL
  F214    35             C              DEC  (HL)         ;Tastaturzaehler
  F215    3E 01          C              LD   A,CPMMOD
  F217    D3 1E          C              OUT  (MAP),A
  F219    1A             C              LD   A,(DE)       ;Tastencode
  F21A    E1             C              POP  HL
  F21B    D1             C              POP  DE
  F21C    C1             C              POP  BC
  F21D    F3             C              DI
  F21E    ED 7B F5DD     C              LD   SP,(SAVSTK)
  F222    FB             C              EI
  F223    C9             C              RET
                         C      ;
  F224    F3             C      CONST:  DI
  F225    ED 73 F5DD     C              LD   (SAVSTK),SP
  F229    31 F65D        C              LD   SP,BIOSTK
  F22C    FB             C              EI
  F22D    3A E67B        C              LD   A,(TZ)       ;Tastaturzaehler?
  F230    B7             C              OR   A
  F231    28 02          C              JR   Z,CONEND     ;keine Taste
  F233    3E FF          C              LD   A,0FFH
  F235    F3             C      CONEND: DI
  F236    ED 7B F5DD     C              LD   SP,(SAVSTK)
  F23A    FB             C              EI
  F23B    C9             C              RET
                         C      ;
  F23C    F3             C      INTA:   DI
  F23D    ED 73 F27A     C              LD   (INSTK),SP
  F241    31 F2A2        C              LD   SP,INSTK1
  F244    F5             C              PUSH AF
  F245    C5             C              PUSH BC
  F246    E5             C              PUSH HL
  F247    DB 04          C              IN   A,(PIO1AD)
  F249    B7             C              OR   A            ;Taste gedrueckt?
  F24A    28 24          C              JR   Z,INTAE
  F24C    21 E67B        C              LD   HL,TZ
  F24F    CB 5E          C              BIT  3,(HL)       ;TAPU - Ueberlauf?
  F251    20 1D          C              JR   NZ,INTAE
  F253    CB BF          C              RES  7,A
  F255    34             C              INC  (HL)
  F256    2A E67E        C              LD   HL,(TZIN)
  F259    77             C              LD   (HL),A
  F25A    23             C              INC  HL
  F25B    CB 9D          C              RES  3,L
  F25D    22 E67E        C              LD   (TZIN),HL
  F260    01 1E0B        C              LD   BC,1E0BH     ;Zeitschleife 100 ms
	MACRO-80 3.44	09-Dec-81	PAGE	1-24


  F263    0B             C      ZS1:    DEC  BC
  F264    78             C              LD   A,B
  F265    B1             C              OR   C
  F266    20 FB          C              JR   NZ,ZS1
  F268    3E B7          C              LD   A,0B7H       ;weitere Interrupts loeschen
  F26A    D3 06          C              OUT  (PIO1AC),A   ;---> Entprellung
  F26C    3E 7F          C              LD   A,7FH
  F26E    D3 06          C              OUT  (PIO1AC),A
  F270    E1             C      INTAE:  POP  HL
  F271    C1             C              POP  BC
  F272    F1             C              POP  AF
  F273    ED 7B F27A     C              LD   SP,(INSTK)
  F277    FB             C              EI
  F278    ED 4D          C              RETI
                         C      ;
  F27A                   C      INSTK:  DEFS 40,0         ;Stack fuer Int.-Entry
  F2A2                   C      INSTK1:
                         C      ;
  F2A2    17FF           C      CURSP:  DEFW 17FFH        ;Kursorposition
  F2A4    00             C              DEFB 0
  F2A5    00             C      ESCCNT: DEFB 0
  F2A6                   C      MERKUR: DEFS 1,0
                         C      ;
                                ;
  F2A7    3A F438               WRITE:  LD   A,(DRIVE)
  F2AA    FE 00                         CP   0
  F2AC    CA EEDD                       JP   Z,WRRDSK
                                        IFDEF FLOPPY
  F2AF    3D                            DEC  A
  F2B0    E6 FE                         AND  0FEH
  F2B2    CA E85F                       JP   Z,WRFLO
                                        ENDIF
  F2B5    3E 01                         LD   A,1          ;ERROR
  F2B7    C9                            RET
                                ;
  F2B8    3A F438               READ:   LD   A,(DRIVE)
  F2BB    FE 00                         CP   0
  F2BD    CA EED6                       JP   Z,RDRDSK
                                        IFDEF FLOPPY
  F2C0    3D                            DEC  A
  F2C1    E6 FE                         AND  0FEH
  F2C3    CA E8D1                       JP   Z,RDFLO
                                        ENDIF
  F2C6    3E 01                         LD   A,1          ;ERROR
  F2C8    C9                            RET
                                ;
  F2C9    C3 F05F               LIST:   JP   CONOUT
                                ;
  F2CC    3E 00                 LISTST: LD   A,0          ;nicht bereit
  F2CE    C9                            RET
                                ;
  F2CF    C3 F05F               PUNCH:  JP   CONOUT
                                ;
  F2D2    C3 F1D8               READER: JP   CONIN
                                ;
  F2D5    21 F370               DERROR: LD   HL,TEXT2
  F2D8    CD F2E7                       CALL OUTTXT
  F2DB    21 F378               ERROR:  LD   HL,TEXT3
  F2DE    CD F2E7                       CALL OUTTXT
                                        IFDEF FLOPPY
	MACRO-80 3.44	09-Dec-81	PAGE	1-25


  F2E1    CD E941                       CALL MOTOFF       ;Floppy-Motor ausschalten
                                        ENDIF
  F2E4    C3 E726                       JP   WBOOT
                                ;
  F2E7    F5                    OUTTXT: PUSH AF
  F2E8    C5                            PUSH BC
  F2E9    7E                    TXTLOP: LD   A,(HL)
  F2EA    FE 00                         CP   0
  F2EC    28 07                         JR   Z,TXTEND
  F2EE    4F                            LD   C,A
  F2EF    CD F05F                       CALL CONOUT
  F2F2    23                            INC  HL
  F2F3    18 F4                         JR   TXTLOP
  F2F5    C1                    TXTEND: POP  BC
  F2F6    F1                            POP  AF
  F2F7    C9                            RET
                                ;
  F2F8    0C 1B 03 0B           TEXT1:  DEFB 0CH,1BH,03H,0BH
  F2FC    20 43 50 2F                   DEFM ' CP/M 2.2  Version 1.51 fuer den AC1-2010 '
  F300    4D 20 32 2E           
  F304    32 20 20 56           
  F308    65 72 73 69           
  F30C    6F 6E 20 31           
  F310    2E 35 31 20           
  F314    66 75 65 72           
  F318    20 64 65 6E           
  F31C    20 41 43 31           
  F320    2D 32 30 31           
  F324    30 20                 
  F326    0D 0A 0A 0A                   DEFB 0DH,0AH,0AH,0AH
  F32A    41 3A 52 41                   DEFM 'A:RAM-Disk '
  F32E    4D 2D 44 69           
  F332    73 6B 20              
  F335    00                            DEFB 00H
  F336    32 35 36 4B           TEXT1A: DEFM "256K"
  F33A    00                            DEFB 00H
  F33B    35 31 32 4B           TEXT1B: DEFM "512K"
  F33F    00                            DEFB 00H
  F340    31 30 32 34           TEXT1C: DEFM "1024K"
  F344    4B                    
  F345    00                            DEFB 00H
  F346    32 30 34 38           TEXT1D: DEFM "2048K"
  F34A    4B                    
  F34B    00                            DEFB 00H
                                IFDEF FLOPPY
  F34C    20 20 42 3A           TEXT1E: DEFM '  B:Floppy 780K  C:Floppy 800K  '
  F350    46 6C 6F 70           
  F354    70 79 20 37           
  F358    38 30 4B 20           
  F35C    20 43 3A 46           
  F360    6C 6F 70 70           
  F364    79 20 38 30           
  F368    30 4B 20 20           
                                ELSE
                                TEXT1E: DEFM ' (System-Track=255)  '
                                ENDIF
  F36C    0D 0A 0A 00                   DEFB 0DH,0AH,0AH,00H
  F370    0D 0A                 TEXT2:  DEFB 0DH,0AH
  F372    44 69 73 6B                   DEFM 'Disk-'
  F376    2D                    
	MACRO-80 3.44	09-Dec-81	PAGE	1-26


  F377    00                            DEFB 00H
  F378    45 52 52 4F           TEXT3:  DEFM 'ERROR'
  F37C    52                    
  F37D    0D 0A 07 00                   DEFB 0DH,0AH,07H,00H
                                ;
  F381    0000                  DPH:    DEFW 0            ;RAM-Disk 256K
  F383    0000                          DEFW 0
  F385    0000                          DEFW 0
  F387    0000                          DEFW 0
  F389    F439                          DEFW DIRBF
  F38B    F3B1                          DEFW DPB0
  F38D    0000                          DEFW 0            ;weil nichtwechselbares Medium
  F38F    F4B9                          DEFW ALL0
                                ;
                                IFDEF FLOPPY
  F391    0000                          DEFW 0            ;Floppy 780K
  F393    0000                          DEFW 0
  F395    0000                          DEFW 0
  F397    0000                          DEFW 0
  F399    F439                          DEFW DIRBF
  F39B    F3C2                          DEFW DPB1
  F39D    F56B                          DEFW CHK1
  F39F    F539                          DEFW ALL1
                                ;
  F3A1    0000                          DEFW 0            ;Floppy 800K
  F3A3    0000                          DEFW 0
  F3A5    0000                          DEFW 0
  F3A7    0000                          DEFW 0
  F3A9    F439                          DEFW DIRBF
  F3AB    F3D3                          DEFW DPB2
  F3AD    F5BD                          DEFW CHK2
  F3AF    F58B                          DEFW ALL2
                                ENDIF
                                ;
                                ;Disk-Parameter-Block  RAM-Disk A: 256K
                                ;
  F3B1    0040                  DPB0:   DEFW 64           ;64 Sectoren/Track (Rec/Trk) = 8 Kbyte/Track
  F3B3    03                            DEFB 3            ;Blockgroesse = 1 Kbyte
  F3B4    07                            DEFB 7
  F3B5    00                            DEFB 0            ;8-Bit Blockadressen im FCB/DIR, da weniger als 255 Bloecke
  F3B6    00F7                          DEFW 247          ;248 * 1 Kbyte-Bloecke  -> 256k-8k(System)=248k(CP/M) ( - 2k(DIR) -> 246k (NETTO f. Daten))
  F3B8    003F                          DEFW 63           ;64 DIR - Eintaege
  F3BA    00C0                          DEFW 0C0H         ;2 DIR-Bloecke
  F3BC    0000                          DEFW 0            ;weil nichtwechselbares Medium
  F3BE    0001                          DEFW 1            ;8 Kbyte System / Track-Offset
                                ;
  F3C0    0000                          DEFW 0
                                ;
                                IFDEF FLOPPY
                                ;
                                ;Disk-Parameter-Block  Floppy B: 780K
                                ;
  F3C2    0050                  DPB1:   DEFW 80           ;80 Sectoren/Track
  F3C4    04                            DEFB 4            ;Blockgroesse = 2 Kbyte
  F3C5    0F                            DEFB 15
  F3C6    00                            DEFB 0
  F3C7    0185                          DEFW 389          ;390 * 2 Kbyte - Bloecke
  F3C9    007F                          DEFW 127          ;128 DIR - Eintraege
  F3CB    00C0                          DEFW 0C0H         ;pro DIR-Block 1Bit gesetzt
  F3CD    0020                          DEFW 32
	MACRO-80 3.44	09-Dec-81	PAGE	1-27


  F3CF    0002                          DEFW 2            ;20 Kbyte System
                                ;
  F3D1    0000                          DEFW 0
                                ;
                                ;
                                ;Disk-Parameter-Block  Floppy C: 800K
                                ;
  F3D3    0050                  DPB2:   DEFW 80           ;80 Sectoren/Track
  F3D5    04                            DEFB 4            ;Blockgroesse = 2 Kbyte
  F3D6    0F                            DEFB 15
  F3D7    00                            DEFB 0
  F3D8    018F                          DEFW 399          ;400 * 2 Kbyte - Bloecke
  F3DA    00BF                          DEFW 191          ;192 DIR - Eintraege
  F3DC    00E0                          DEFW 0E0H         ;3 DIR-Bloecke
  F3DE    0030                          DEFW 48
  F3E0    0000                          DEFW 0            ;0 Kbyte System
                                ;
  F3E2    0000                          DEFW 0
                                ENDIF
                                ;
                                ;Disk-Parameter-Bloecke fuer RAM-Disk 512 / 1024 / 2048 KByte
                                ;
                                ;RAM-Disk 512 KByte  LW A:
  F3E4    0040                  DP512:  DEFW 64           ;64 Sectoren/Track (Rec/Trk) = 8 Kbyte/Track
  F3E6    04                            DEFB 4            ;Blockgroesse = 2 Kbyte
  F3E7    0F                            DEFB 15
  F3E8    01                            DEFB 1            ;8-Bit Blockadressen im FCB/DIR, da weniger als 255 Bloecke
  F3E9    00FB                          DEFW 251          ;252 * 2 Kbyte-Bloecke  -> 512k-8k(System)=504k(CP/M) ( - 2k(DIR) -> 502k (NETTO f. Daten))
  F3EB    003F                          DEFW 63           ;64 DIR - Eintaege
  F3ED    0080                          DEFW 080H         ;1 DIR-Block
  F3EF    0000                          DEFW 0            ;weil nichtwechselbares Medium
  F3F1    0001                          DEFW 1            ;8 Kbyte System / Track-Offset
                                ;
                                ;RAM-Disk 1024 KByte  LW A:
  F3F3    0040                  DP1024: DEFW 64           ;64 Sectoren/Track (Rec/Trk) = 8 Kbyte/Track
  F3F5    04                            DEFB 4            ;Blockgroesse = 2 Kbyte
  F3F6    0F                            DEFB 15
  F3F7    00                            DEFB 0            ;16-Bit Blockadressen im FCB/DIR, da mehr als 255 Bloecke
  F3F8    01FB                          DEFW 507          ;508 * 2 Kbyte-Bloecke  -> 1024k-8k(System)=1016k(CP/M) ( - 4k(DIR) -> 1012k (NETTO f. Daten))
  F3FA    007F                          DEFW 127          ;128 DIR - Eintraege -> bei 64 DIR-Eintraegen bekommt man die RAM-Disk nicht voll
  F3FC    00C0                          DEFW 0C0H         ;2 DIR-Bloecke
  F3FE    0000                          DEFW 0            ;weil nichtwechselbares Medium
  F400    0001                          DEFW 1            ;8 Kbyte System / Track-Offset
                                ;
                                ;RAM-Disk 2048 KByte  LW A:
  F402    0040                  DP2048: DEFW 64           ;64 Sectoren/Track (Rec/Trk) = 8 Kbyte/Track
  F404    04                            DEFB 4            ;Blockgroesse = 2 Kbyte
  F405    0F                            DEFB 15
  F406    00                            DEFB 0            ;16-Bit Blockadressen im FCB/DIR, da mehr als 255 Bloecke
  F407    03FB                          DEFW 1019         ;1020 * 2 Kbyte-Bloecke  -> 2048k-8k(System)=2040k(CP/M) ( - 8k(DIR) -> 2032k (NETTO f. Daten))
  F409    00FF                          DEFW 255          ;256 DIR - Eintraege
  F40B    00F0                          DEFW 0F0H         ;4 DIR-Bloecke
  F40D    0000                          DEFW 0            ;weil nichtwechselbares Medium
  F40F    0001                          DEFW 1            ;8 Kbyte System / Track-Offset
                                ;
                                ; CP/M verlassen
                                ;
  F411    F3                    EXIT:   DI
  F412    31 2000                       LD   SP,2000H
  F415    21 D007                       LD   HL,CCP+7
	MACRO-80 3.44	09-Dec-81	PAGE	1-28


  F418    36 00                         LD   (HL),0       ;Kommandopuffer loeschen
  F41A    3E 00                         LD   A,AC1MOD
  F41C    D3 1E                         OUT  (MAP),A
  F41E    3E 03                         LD   A,3          ;verbiete Interrupt
  F420    D3 06                         OUT  (PIO1AC),A
  F422    3E 4F                         LD   A,4FH        ;PIO - Mode 1
  F424    D3 06                         OUT  (PIO1AC),A
  F426    21 103F                       LD   HL,103FH
  F429    22 1800                       LD   (1800H),HL   ;neue Kursorposition
  F42C    3E 0F                         LD   A,0FH
  F42E    36 20                 EXIT1:  LD   (HL),20H     ;letzte BS-Zeile loeschen
  F430    2B                            DEC  HL
  F431    BC                            CP   H
  F432    20 FA                         JR   NZ,EXIT1
  F434    C3 07FD                       JP   GETCO        ;Ruecksprung in den AC1-Monitor
                                ;
                                ; RAM-Zellen
                                ;
                                IFDEF FLOPPY
  F437    03                    NDISK:  DEFB 3            ;Anzahl der LW
                                ELSE
                                NDISK:  DEFB 1            ;Anzahl der LW
                                TRACK:  DEFB 0            ;FLOPPY.INC ist ausgeblendet
                                SECTOR: DEFB 1            ;TRACK muss dort bleiben, weil
                                DMA:    DEFW 0080H        ;es in CTAB/CTAB2 verwendet wird
                                ENDIF
  F438    00                    DRIVE:  DEFB 0            ;Merker aktuelles LW
                                ;
  F439                          DIRBF:  DEFS 80H,0
  F4B9                          ALL0:   DEFS 128,0        ;Anzahl der Bit's = Anzahl der
                                IFDEF FLOPPY
  F539                          ALL1:   DEFS 50,0         ;Bloecke, die zu verwalten sind
  F56B                          CHK1:   DEFS 32,0         ;= CKS im DPB = DIR-Entrys/4
  F58B                          ALL2:   DEFS 50,0         ;Bloecke, die zu verwalten sind
  F5BD                          CHK2:   DEFS 32,0         ;= CKS im DPB = DIR-Entrys/4
                                ENDIF
                                ;
  F5DD                          SAVSTK: DEFS 80H,0
  F65D                          BIOSTK:
                                ;
  F65D    45 6E 64 20                   DEFM 'End of BIOS'
  F661    6F 66 20 42           
  F665    49 4F 53              
                                ;
                                        .DEPHASE
                                        END
	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
0000 	AC1MOD          0043 	AKWAIT          F4B9 	ALL0            
F539 	ALL1            F58B 	ALL2            D806 	BDOS            
F128 	BEEP            F12A 	BEEP0           F12C 	BEEP1           
E600 	BIOS            F65D 	BIOSTK          E603 	BIOSWB          
EACE 	BLTEST          E68A 	BOOT            E6F4 	BOOT2           
E6FC 	BOOT3           F100 	BS              D000 	CCP             
EFAA 	CCPRD           EFB6 	CCPRD1          EF88 	CCPWR           
EF94 	CCPWR1          0040 	CFDC            F56B 	CHK1            
F5BD 	CHK2            F15D 	CLRTES          F103 	CLS             
F1C0 	COEND           F19D 	COEND1          F1EB 	COIN1           
F1ED 	COIN2           F1F0 	COIN3           F235 	CONEND          
F1D8 	CONIN           F05F 	CONOUT          F224 	CONST           
E836 	CPLW            E85D 	CPLW1           E855 	CPLW2           
E83C 	CPLW3           0001 	CPMMOD          E7EC 	CPSEC           
E7F6 	CPSEC1          E804 	CPSEC2          E80C 	CPSEC3          
F0F9 	CR              EAB4 	CTAB            EAC5 	CTAB2           
F11F 	CUHOME          F190 	CUOFF           F17E 	CUON            
F142 	CURECH          005F 	CURSOR          F2A2 	CURSP           
F14F 	CURSUP          F145 	DEL             E9A2 	DEL1            
E99F 	DELAY           F167 	DELEND          F173 	DELLIN          
F2D5 	DERROR          0041 	DFDC            F088 	DIPOS           
F097 	DIPOS1          F439 	DIRBF           E770 	DISK            
E783 	DISK1           E795 	DISK2           0044 	DL175           
EAAF 	DMA             F3F3 	DP1024          F402 	DP2048          
F3E4 	DP512           F3B1 	DPB0            F3C2 	DPB1            
F3D3 	DPB2            E7AD 	DPB780          E79C 	DPB800          
F381 	DPH             F438 	DRIVE           E7D5 	DSK780          
E7BE 	DSK800          E79B 	DSKSET          EABC 	DTL             
EABA 	EOT             F2DB 	ERROR           F117 	ESCAPE          
F2A5 	ESCCNT          F411 	EXIT            F42E 	EXIT1           
EAB1 	FDCCOM          EAD1 	FDMA            EAD0 	FLFLAG          
0001 	FLOPPY          07FD 	GETCO           EABB 	GPL             
EAB7 	HEAD            E66A 	HOME            E91D 	HSTRD           
E920 	HSTWR           E81F 	INHEAD          EA21 	INITF1          
EA27 	INITF2          EA33 	INITF3          EA11 	INITFL          
F050 	INITOK          EF30 	INITR1          EF52 	INITR2          
EF60 	INITR3          EF6C 	INITR4          EF1A 	INITRD          
F27A 	INSTK           F2A2 	INSTK1          F23C 	INTA            
F270 	INTAE           0003 	IOBYTE          E9CB 	IRDY            
E688 	IV              F206 	KEY             F13A 	LF              
F2C9 	LIST            F2CC 	LISTST          0004 	LWBYTE          
001E 	MAP             F2A6 	MERKUR          E9EF 	MODE0           
E9F5 	MODE1           E941 	MOTOFF          E90E 	MOTON           
E92A 	MOTOR0          E928 	MOTOR1          EAB9 	N               
EABD 	N2              F437 	NDISK           F04A 	NOTXT           
F1C7 	ON1             E92E 	ONLOOP          F2E7 	OUTTXT          
F19B 	OUTZEI          0006 	PIO1AC          0004 	PIO1AD          
0007 	PIO1BC          0005 	PIO1BD          E676 	PLATZ           
E94E 	PRECOM          F2CF 	PUNCH           EA6A 	R8272           
E9A6 	RBYTE           00E0 	RDADR           EEE4 	RDARI           
E8D1 	RDFLO           EED1 	RDMERK          EED6 	RDRDSK          
EED5 	RDSIZE          EFCC 	RDTEST          EFD8 	RDTST1          
EFEA 	RDTST2          EFFA 	RDTST3          F00C 	RDTST4          
F017 	RDTST5          F028 	RDTXT           E97F 	RDY             
F2B8 	READ            E8EE 	READ1           F2D2 	READER          
EA04 	REGDEL          EABE 	RESLT           E9AF 	RRSLT           
	MACRO-80 3.44	09-Dec-81	PAGE	S-1


E9B7 	RRSLT1          E9DC 	RW              E9E9 	RW1             
E9F2 	RW2             EAA5 	RWEND           EA6F 	RWIT            
EA82 	RWOP            EACF 	RWTEST          F5DD 	SAVSTK          
E959 	SDS             EAAE 	SECTOR          EAB8 	SECTR           
E660 	SECTRN          E963 	SEEK            E656 	SELDS1          
E641 	SELDSK          EA4F 	SENSE           E671 	SETDMA          
E665 	SETSEC          E66C 	SETTRK          E974 	SKBSY           
F15F 	SPACE1          F16C 	SPACE2          F1BB 	SPACE3          
E9DA 	STAB            EAB3 	STREG           E680 	TAPU            
F2F8 	TEXT1           F336 	TEXT1A          F33B 	TEXT1B          
F340 	TEXT1C          F346 	TEXT1D          F34C 	TEXT1E          
F370 	TEXT2           F378 	TEXT3           F04E 	TICK            
EAB6 	TRACK           F2F5 	TXTEND          F2E9 	TXTLOP          
E67B 	TZ              E67E 	TZIN            E67C 	TZOUT           
EAB5 	UNIT            F153 	UP1             F0AB 	VERGL           
EA63 	W8272           E726 	WBOOT           E741 	WBOOT1          
E989 	WCOM            E98C 	WCOM1           E85F 	WRFLO           
F2A7 	WRITE           E87B 	WRITE1          E88B 	WRITE2          
E89E 	WRITE3          E8B7 	WRITE4          EEDD 	WRRDSK          
F046 	YESTXT          EA06 	ZEIT1           F263 	ZS1             



No Fatal error(s)


    
